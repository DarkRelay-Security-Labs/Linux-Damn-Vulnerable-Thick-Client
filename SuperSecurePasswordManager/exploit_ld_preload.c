#include <stdio.h>
#include <string.h>

#define INDICATOR_FILE "/tmp/ld_preload_exploit_indicator"

// Log indicator when the library is loaded
void log_indicator(const char* message) {
    FILE *file = fopen(INDICATOR_FILE, "a");
    if (file) {
        fprintf(file, "%s\n", message);
        fclose(file);
    }
}

// Constructor to ensure logging when the library is loaded
__attribute__((constructor)) void init() {
    log_indicator("LD_PRELOAD: Malicious library loaded successfully");
}
